(window.webpackJsonp=window.webpackJsonp||[]).push([[526],{1902:function(s,a,n){"use strict";n.r(a);var t=n(5),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"签署工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#签署工作"}},[s._v("#")]),s._v(" 签署工作")]),s._v(" "),a("p",[s._v("Git 虽然是密码级安全的，但它不是万无一失的。 如果你从因特网上的其他人那里拿取工作，并且 "),a("strong",[s._v("想要验证提交是不是真正地来自于可信来源")]),s._v("，Git 提供了几种通过 GPG 来签署和验证工作的方式。")]),s._v(" "),a("h2",{attrs:{id:"gpg-介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gpg-介绍"}},[s._v("#")]),s._v(" GPG 介绍")]),s._v(" "),a("p",[s._v("首先，在开始签名之前你需要先配置 GPG 并安装个人密钥。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ gpg --list-keys\n/Users/schacon/.gnupg/pubring.gpg\n---------------------------------\npub   2048R/0A46826A "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v("-06-04\nuid                  Scott Chacon "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Git signing key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("schacon@gmail.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nsub   2048R/874529A9 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v("-06-04\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("如果你还没有安装一个密钥，可以使用 "),a("code",[s._v("gpg –gen-key")]),s._v(" 生成一个。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ gpg --gen-key\ngpg "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GnuPG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.2")]),s._v(".23-unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Copyright "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("C"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" Free Software Foundation, Inc.\nThis is "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" software: you are "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nNote: Use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gpg --full-generate-key"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a full featured key generation dialog.\n\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: zqzqzq\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入一个至少 5 位数的密匙 ID")]),s._v("\nEmail address: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99299684")]),s._v("@qq.com   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 你的邮箱")]),s._v("\nYou selected this "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("-ID:\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面是生成的 user-id")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zqzqzq <99299684@qq.com>"')]),s._v("\n\nChange "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("ame, "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("mail, or "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("O"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("kay/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Q"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("uit? o  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入 o 开始生成")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 特别注意这里，会弹出一个对话框，叫你输入你密匙的 密码，我这里输入的是 12345678，会输入两次")]),s._v("\nWe need to generate a lot of random bytes. It is a good idea to perform\nsome other action "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type on the keyboard, move the mouse, utilize the\ndisks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" during the prime generation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" this gives the random number\ngenerator a better chance to gain enough entropy.\nWe need to generate a lot of random bytes. It is a good idea to perform\nsome other action "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type on the keyboard, move the mouse, utilize the\ndisks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" during the prime generation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" this gives the random number\ngenerator a better chance to gain enough entropy.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面是生成过程的说明，下面是生成好的密匙信息与存储路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意这里的 key 5EEB7501BA64A581，他可以用来代替 user id，签署的时候也是用的他")]),s._v("\ngpg: key 5EEB7501BA64A581 marked as ultimately trusted\ngpg: directory "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/c/Users/zq/.gnupg/openpgp-revocs.d'")]),s._v(" created\ngpg: revocation certificate stored as "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/c/Users/zq/.gnupg/openpgp-revocs.d/46AD35DEB41E02E793366B255EEB7501BA64A581.rev'")]),s._v("\npublic and secret key created and signed.\n\npub   rsa3072 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-11-05 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("expires: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-11-05"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      46AD35DEB41E02E793366B255EEB7501BA64A581\nuid                      zqzqzq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99299684")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nsub   rsa3072 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-11-05 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("expires: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-11-05"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("一旦你有一个可以签署的私钥，可以通过设置 Git 的 "),a("code",[s._v("user.signingkey")]),s._v("  选项来签署。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 笔者这是新版的 git (v2.x)生成的，可能和上面书上讲解的信息不太一致")]),s._v("\n$ gpg --list-keys\ngpg: checking the trustdb\ngpg: marginals needed: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  completes needed: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  trust model: pgp\ngpg: depth: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  valid:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  signed:   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  trust: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("-, 0q, 0n, 0m, 0f, 1u\ngpg: next trustdb check due at "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-11-05\n/c/Users/zq/.gnupg/pubring.kbx\n------------------------------\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意这里第二列的信息，不会显示所属的 user-id 的 hash 字符串")]),s._v("\npub   rsa3072 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-11-05 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("expires: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-11-05"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      46AD35DEB41E02E793366B255EEB7501BA64A581\nuid           "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ultimate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" zqzqzq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99299684")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nsub   rsa3072 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-11-05 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("expires: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-11-05"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置密匙")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意这里填写的是用户id 的 hash 字符串")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.signingkey 5EEB7501BA64A581\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("现在 Git 默认使用你的密钥来签署标签与提交。")]),s._v(" "),a("p",[s._v("有关 GPG 入门详细信息，请参考 "),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2013/07/gpg.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("《阮一峰的 GPG 入门教程》"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"签署标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#签署标签"}},[s._v("#")]),s._v(" 签署标签")]),s._v(" "),a("p",[s._v("如果已经设置好一个 GPG 私钥，可以使用它来签署新的标签。 所有需要做的只是使用 "),a("code",[s._v("-s")]),s._v(" 代替 "),a("code",[s._v("-a")]),s._v(" 即可：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tag "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" v1.5 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my signed 1.5 tag'")]),s._v("\n\nYou need a passphrase to unlock the secret key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\nuser: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ben Straub <ben@straub.cc>"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("-bit RSA key, ID 800430EB, created "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v("-05-04\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意: 这一步在新版 git bash 中，执行标签签署命令，同样会弹出一个对话框，让你输入你的密匙密码")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("如果在那个标签上运行 git show，会看到你的 GPG 签名附属在后面：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" show v1.5\ntag v1.5\nTagger: Ben Straub "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ben@straub.cc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nDate:   Sat May "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":29:41 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-0700")]),s._v("\n\nmy signed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.5")]),s._v(" tag\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJTZbQlAAoJEF0+sviABDDrZbQH/09PfE51KPVPlanr6q1v4/Ut\nLQxfojUWiLQdg2ESJItkcuweYg+kc3HCyFejeDIBw9dpXt00rY26p05qrpnG+85b\nhM1/PswpPLuBSr+oCIDj5GMC2r2iEKsfv2fJbNW8iWAXVLoWZRF8B0MfqX/YTMbm\necorc4iXzQu7tupRihslbNkfvfciMnSDeSvzCpWAHl7h8Wj6hhqePmLm9lAYqnKp\n8S5B/1SSQuEAjRZgI4IexpZoeKGVDptPHxLLS38fozsyi0QyDyzEgJxcJQVMXxVi\nRUysgqjcpT8+iQM1PblGfHR4XAhuOqN5Fx06PSaFZhqvWFezJ28/CLyX5q+oIVk"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EFTF\n-----END PGP SIGNATURE-----\n\ncommit ca82a6dff817ec66f44342007202690a93763949\nAuthor: Scott Chacon "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("schacon@gee-mail.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nDate:   Mon Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":52:11 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2008")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-0700")]),s._v("\n\n    changed the version number\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"验证标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证标签"}},[s._v("#")]),s._v(" 验证标签")]),s._v(" "),a("p",[s._v("要验证一个签署的标签，可以运行 "),a("code",[s._v("git tag -v [tag-name]")]),s._v("。 这个命令使用 GPG 来验证签名。 为了验证能正常工作，"),a("strong",[s._v("签署者的公钥需要在你的钥匙链中")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tag "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" v1.4.2.1\nobject 883653babd8ee7ea23e6a5c392bb739348b1eb61\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" commit\ntag v1.4.2.1\ntagger Junio C Hamano "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("junkio@cox.net"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1158138501")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-0700")]),s._v("\n\nGIT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(".2.1\n\nMinor fixes since "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.4")]),s._v(".2, including git-mv and git-http with alternates.\ngpg: Signature made Wed Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" 02:08:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2006")]),s._v(" PDT using DSA key ID F3119B9A\ngpg: Good signature from "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Junio C Hamano <junkio@cox.net>"')]),s._v("\ngpg:                 aka "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[jpeg image of size 1513]"')]),s._v("\nPrimary key fingerprint: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3565")]),s._v(" 2A26 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2040")]),s._v(" E066 C9A7  4A7D C0C6 D9A4 F311 9B9A\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("果没有签署者的公钥，那么你将会得到类似下面的东西：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("gpg: Signature made Wed Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" 02:08:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2006")]),s._v(" PDT using DSA key ID F3119B9A\ngpg: Can"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t check signature: public key not found\nerror: could not verify the tag '")]),s._v("v1.4.2.1'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"签署提交"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#签署提交"}},[s._v("#")]),s._v(" 签署提交")]),s._v(" "),a("p",[s._v("在最新版本的 Git 中（v1.7.9 及以上），也可以签署个人提交。 如果相对于标签而言你对直接签署到提交更感兴趣的话，所有要做的只是增加一个 "),a("code",[s._v("-S")]),s._v(" 到 "),a("code",[s._v("git commit")]),s._v(" 命令。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'signed commit'")]),s._v("\n\nYou need a passphrase to unlock the secret key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\nuser: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scott Chacon (Git signing key) <schacon@gmail.com>"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("-bit RSA key, ID 0A46826A, created "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v("-06-04\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master 5c3386c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" signed commit\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" files changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" deletions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n rewrite Rakefile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n create mode "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100644")]),s._v(" lib/git.rb\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("code",[s._v("git log")]),s._v(" 也有一个 "),a("code",[s._v("–show-signature")]),s._v(" 选项来查看及验证这些签名。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log --show-signature "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("\ncommit 5c3386cf54bba0a33a32da706aa52bc0155503c2\ngpg: Signature made Wed Jun  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":49:17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" PDT using RSA key ID 0A46826A\ngpg: Good signature from "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scott Chacon (Git signing key) <schacon@gmail.com>"')]),s._v("\nAuthor: Scott Chacon "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("schacon@gmail.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nDate:   Wed Jun "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":49:17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-0700")]),s._v("\n\n    signed commit\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("另外，也可以配置 git log 来验证任何找到的签名并将它们以 "),a("code",[s._v("%G?")]),s._v(" 格式列在输出中。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" log "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--pretty")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"format:%h %G? %aN  %s"')]),s._v("\n\n5c3386c G Scott Chacon  signed commit\nca82a6d N Scott Chacon  changed the version number\n085bb3b N Scott Chacon  removed unnecessary "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" code\na11bef0 N Scott Chacon  first commit\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("这里我们可以看到只有最后一次提交是签署并有效的，而之前的提交都不是。")]),s._v(" "),a("p",[s._v("在 Git 1.8.3 及以后的版本中，"),a("code",[s._v("git merge")]),s._v("  与 "),a("code",[s._v("git pull")]),s._v("  可以使用  "),a("code",[s._v("–verify-signatures")]),s._v("  选项来检查并拒绝没有携带可信 GPG 签名的提交。")]),s._v(" "),a("p",[s._v("如果使用这个选项来合并一个包含未签名或有效的提交的分支时，合并不会生效。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --verify-signatures non-verify\nfatal: Commit ab06180 does not have a GPG signature.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("如果合并包含的只有有效的签名的提交，合并命令会提示所有的签名它已经检查过了然后会继续向前。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --verify-signatures signed-branch\nCommit 13ad65e has a good GPG signature by Scott Chacon "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Git signing key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("schacon@gmail.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nUpdating 5c3386c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("13ad65e\nFast-forward\n README "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" ++\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("也可以给 "),a("code",[s._v("git merge")]),s._v(" 命令附加 "),a("code",[s._v("-S")]),s._v("  选项来签署自己生成的合并提交。 下面的例子演示了验证将要合并的分支的每一个提交都是签名的并且签署最后生成的合并提交。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --verify-signatures "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v("  signed-branch\nCommit 13ad65e has a good GPG signature by Scott Chacon "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Git signing key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("schacon@gmail.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nYou need a passphrase to unlock the secret key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\nuser: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scott Chacon (Git signing key) <schacon@gmail.com>"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("-bit RSA key, ID 0A46826A, created "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v("-06-04\n\nMerge made by the "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'recursive'")]),s._v(" strategy.\n README "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" ++\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"每个人必须签署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#每个人必须签署"}},[s._v("#")]),s._v(" 每个人必须签署")]),s._v(" "),a("p",[s._v("签署标签与提交很棒，但是如果决定在正常的工作流程中使用它，你必须确保团队中的每一个人都理解如何这样做。 如果没有，你将会花费大量时间帮助其他人找出并用签名的版本重写提交。 在采用签署成为标准工作流程的一部分前，确保你完全理解 GPG 及签署带来的好处。")])])}),[],!1,null,null,null);a.default=e.exports}}]);